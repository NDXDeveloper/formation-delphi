üîù Retour au [Sommaire](/SOMMAIRE.md)

# 3.7.1 Classes et objets en Object Pascal

## Introduction √† la programmation orient√©e objet

La programmation orient√©e objet (POO) est un paradigme de programmation qui permet d'organiser le code de mani√®re plus structur√©e et r√©utilisable. Au lieu de penser uniquement en termes de proc√©dures et de fonctions qui manipulent des donn√©es, la POO nous invite √† penser en termes d'**objets** qui combinent donn√©es et comportements.

En Delphi, la POO est au c≈ìur du langage Object Pascal. Comprendre les classes et les objets est essentiel pour tirer pleinement parti de Delphi.

## Qu'est-ce qu'une classe ?

Une **classe** est un mod√®le ou un plan qui d√©crit la structure et le comportement d'un type d'objet. Pensez √† une classe comme √† un moule √† g√¢teau : le moule d√©finit la forme, mais ce n'est pas le g√¢teau lui-m√™me.

Une classe contient :
- **Des champs** (ou attributs) : les donn√©es que l'objet va stocker
- **Des m√©thodes** : les actions que l'objet peut effectuer

## Qu'est-ce qu'un objet ?

Un **objet** est une instance concr√®te d'une classe. Si la classe est le moule, l'objet est le g√¢teau cr√©√© √† partir de ce moule. Vous pouvez cr√©er autant d'objets que vous le souhaitez √† partir d'une m√™me classe.

## D√©finir une classe simple

Voici comment d√©finir une classe en Object Pascal :

```pascal
type
  TPersonne = class
  private
    FNom: string;
    FAge: Integer;
  public
    procedure SePresenter;
  end;
```

### D√©cortiquons cette d√©finition

- `type` : mot-cl√© qui introduit une d√©finition de type
- `TPersonne` : le nom de la classe (par convention, les classes commencent par `T`)
- `class` : mot-cl√© indiquant qu'il s'agit d'une classe
- `private` : section pour les membres priv√©s (accessibles uniquement √† l'int√©rieur de la classe)
- `FNom`, `FAge` : champs priv√©s (par convention, pr√©fix√©s par `F` pour "Field")
- `public` : section pour les membres publics (accessibles de l'ext√©rieur)
- `SePresenter` : une m√©thode publique

## Impl√©mentation des m√©thodes

Apr√®s avoir d√©clar√© la classe, nous devons impl√©menter ses m√©thodes :

```pascal
procedure TPersonne.SePresenter;
begin
  ShowMessage('Bonjour, je m''appelle ' + FNom +
              ' et j''ai ' + IntToStr(FAge) + ' ans.');
end;
```

La notation `TPersonne.SePresenter` indique que cette proc√©dure appartient √† la classe `TPersonne`.

## Cr√©er et utiliser un objet

Pour utiliser une classe, nous devons cr√©er un objet (une instance) :

```pascal
var
  UnePersonne: TPersonne;
begin
  // Cr√©er l'objet
  UnePersonne := TPersonne.Create;

  try
    // Utiliser l'objet
    UnePersonne.FNom := 'Marie';
    UnePersonne.FAge := 25;
    UnePersonne.SePresenter;
  finally
    // D√©truire l'objet pour lib√©rer la m√©moire
    UnePersonne.Free;
  end;
end;
```

### Points importants

1. **Create** : m√©thode h√©rit√©e qui cr√©e l'instance en m√©moire
2. **try...finally** : bloc garantissant la lib√©ration de la m√©moire
3. **Free** : m√©thode qui d√©truit l'objet et lib√®re la m√©moire

## Exemple complet d'une classe

Voici un exemple plus complet d'une classe repr√©sentant un compte bancaire :

```pascal
type
  TCompteBancaire = class
  private
    FTitulaire: string;
    FSolde: Double;
  public
    procedure Deposer(Montant: Double);
    procedure Retirer(Montant: Double);
    function ObtenirSolde: Double;
    procedure AfficherInfos;
  end;

// Impl√©mentation des m√©thodes

procedure TCompteBancaire.Deposer(Montant: Double);
begin
  if Montant > 0 then
    FSolde := FSolde + Montant;
end;

procedure TCompteBancaire.Retirer(Montant: Double);
begin
  if (Montant > 0) and (FSolde >= Montant) then
    FSolde := FSolde - Montant
  else
    ShowMessage('Solde insuffisant ou montant invalide');
end;

function TCompteBancaire.ObtenirSolde: Double;
begin
  Result := FSolde;
end;

procedure TCompteBancaire.AfficherInfos;
begin
  ShowMessage('Titulaire: ' + FTitulaire + #13#10 +
              'Solde: ' + FormatFloat('0.00', FSolde) + ' ‚Ç¨');
end;
```

### Utilisation de cette classe

```pascal
var
  MonCompte: TCompteBancaire;
begin
  MonCompte := TCompteBancaire.Create;
  try
    MonCompte.FTitulaire := 'Jean Dupont';
    MonCompte.FSolde := 1000.0; // Initialisation

    MonCompte.Deposer(500);
    MonCompte.Retirer(200);
    MonCompte.AfficherInfos; // Affiche le solde de 1300‚Ç¨
  finally
    MonCompte.Free;
  end;
end;
```

## Les sections de visibilit√©

En Object Pascal, vous pouvez contr√¥ler l'acc√®s aux membres d'une classe avec diff√©rentes sections :

### Private
Les membres `private` ne sont accessibles que depuis l'int√©rieur de la classe elle-m√™me.

```pascal
type
  TMaClasse = class
  private
    FDonneeSecrete: string;  // Accessible uniquement dans TMaClasse
  end;
```

### Public
Les membres `public` sont accessibles de partout.

```pascal
type
  TMaClasse = class
  public
    DonneePublique: string;  // Accessible partout
    procedure MethodePublique;
  end;
```

### Protected
Les membres `protected` sont accessibles dans la classe et ses classes d√©riv√©es (h√©ritage).

```pascal
type
  TMaClasse = class
  protected
    FDonneeProtegee: string;  // Accessible dans cette classe et ses descendants
  end;
```

### Published
Les membres `published` sont publics et visibles dans l'inspecteur d'objets de Delphi (pour les propri√©t√©s).

## Bonnes pratiques

1. **Toujours lib√©rer les objets** : utilisez `try...finally` avec `Free` pour √©viter les fuites m√©moire
2. **Nommage coh√©rent** :
   - Classes : pr√©fixe `T` (TPersonne, TCompte)
   - Champs priv√©s : pr√©fixe `F` (FNom, FSolde)
3. **Encapsulation** : gardez les champs priv√©s et exposez des m√©thodes publiques pour y acc√©der
4. **Une classe, une responsabilit√©** : chaque classe devrait avoir un r√¥le clair et unique

## Diff√©rence entre classe et objet - Analogie

Imaginons la construction d'une maison :

- **La classe** = les plans de la maison (le blueprint)
  - D√©finit combien de pi√®ces, o√π sont les portes, etc.
  - C'est une description abstraite

- **L'objet** = la maison r√©elle construite selon ces plans
  - Une structure concr√®te que vous pouvez habiter
  - Vous pouvez construire plusieurs maisons identiques √† partir des m√™mes plans

En code :

```pascal
type
  TMaison = class  // La classe (les plans)
  private
    FNombrePieces: Integer;
    FCouleur: string;
  end;

var
  MaisonA, MaisonB: TMaison;  // Deux objets (deux maisons)
begin
  MaisonA := TMaison.Create;  // Construire la premi√®re maison
  MaisonB := TMaison.Create;  // Construire la deuxi√®me maison

  // Chaque maison peut avoir des caract√©ristiques diff√©rentes
  MaisonA.FNombrePieces := 5;
  MaisonA.FCouleur := 'Bleue';

  MaisonB.FNombrePieces := 3;
  MaisonB.FCouleur := 'Rouge';
end;
```

## R√©sum√©

- Une **classe** est un mod√®le d√©finissant la structure et le comportement d'objets
- Un **objet** est une instance concr√®te d'une classe
- Les **champs** stockent les donn√©es de l'objet
- Les **m√©thodes** d√©finissent les actions que l'objet peut effectuer
- La **visibilit√©** (private, public, protected) contr√¥le l'acc√®s aux membres
- Il faut toujours cr√©er un objet avec `Create` et le lib√©rer avec `Free`
- Le bloc `try...finally` garantit la lib√©ration de la m√©moire

Les classes et objets sont la fondation de la programmation orient√©e objet en Delphi. Une fois ce concept ma√Ætris√©, vous pourrez explorer les propri√©t√©s, l'h√©ritage, le polymorphisme et tous les autres aspects puissants de la POO.

‚è≠Ô∏è [Propri√©t√©s et m√©thodes](/03-langage-object-pascal/07.2-proprietes-methodes.md)
