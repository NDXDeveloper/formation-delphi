üîù Retour au [Sommaire](/SOMMAIRE.md)

# 4.3.4 Listes et grilles

## Introduction

Lorsque vous devez afficher des **collections de donn√©es** dans votre application, les composants de listes et de grilles sont indispensables. Que ce soit pour afficher une liste de clients, un tableau de produits, ou une grille de donn√©es, ces composants vous permettent de pr√©senter l'information de mani√®re structur√©e et interactive.

Dans cette section, nous allons explorer les principaux composants de listes et grilles de la VCL :
- **TListBox** : Liste simple d'√©l√©ments
- **TCheckListBox** : Liste avec cases √† cocher
- **TStringGrid** : Grille de texte
- **TListView** : Liste avanc√©e avec colonnes et diff√©rentes vues

Ces composants sont essentiels pour cr√©er des interfaces riches permettant √† l'utilisateur de visualiser et s√©lectionner des donn√©es.

## Le composant TListBox (Liste simple)

### Qu'est-ce qu'un TListBox ?

**TListBox** affiche une **liste verticale d'√©l√©ments** parmi lesquels l'utilisateur peut s√©lectionner. C'est l'un des composants les plus simples et les plus utilis√©s pour afficher des listes.

**Utilisations courantes :**
- Afficher une liste de noms, de produits, de cat√©gories
- Permettre la s√©lection d'un ou plusieurs √©l√©ments
- Afficher des r√©sultats de recherche
- Liste de fichiers ou dossiers
- Navigation dans des options

### O√π trouver TListBox ?

TListBox se trouve dans l'onglet **Standard** de la palette de composants.

### Propri√©t√©s essentielles de TListBox

#### 1. Items - Le contenu de la liste

C'est une collection (TStrings) contenant tous les √©l√©ments de la liste :

```pascal
// Ajouter un √©l√©ment
ListBox1.Items.Add('√âl√©ment 1');
ListBox1.Items.Add('√âl√©ment 2');

// Ajouter plusieurs √©l√©ments
ListBox1.Items.AddStrings(['Rouge', 'Vert', 'Bleu', 'Jaune']);

// Ins√©rer un √©l√©ment √† une position
ListBox1.Items.Insert(0, 'Premier √©l√©ment');

// Supprimer un √©l√©ment par index
ListBox1.Items.Delete(0);

// Supprimer un √©l√©ment par valeur
ListBox1.Items.Delete(ListBox1.Items.IndexOf('Rouge'));

// Effacer tous les √©l√©ments
ListBox1.Items.Clear;

// Nombre d'√©l√©ments
NombreElements := ListBox1.Items.Count;

// Acc√©der √† un √©l√©ment
PremierElement := ListBox1.Items[0];
```

**Remplir Items au moment de la conception :**
Dans l'Inspecteur d'objets, double-cliquez sur Items pour ouvrir l'√©diteur de liste.

#### 2. ItemIndex - L'√©l√©ment s√©lectionn√©

Indique quel √©l√©ment est actuellement s√©lectionn√© :

```pascal
// S√©lectionner le premier √©l√©ment (index 0)
ListBox1.ItemIndex := 0;

// S√©lectionner le troisi√®me √©l√©ment
ListBox1.ItemIndex := 2;

// Aucune s√©lection
ListBox1.ItemIndex := -1;

// V√©rifier quel √©l√©ment est s√©lectionn√©
if ListBox1.ItemIndex >= 0 then
  ShowMessage('S√©lection : ' + ListBox1.Items[ListBox1.ItemIndex]);

// V√©rifier si quelque chose est s√©lectionn√©
if ListBox1.ItemIndex = -1 then
  ShowMessage('Aucune s√©lection');
```

#### 3. MultiSelect - S√©lection multiple

Permet de s√©lectionner plusieurs √©l√©ments en m√™me temps :

```pascal
ListBox1.MultiSelect := True;   // S√©lection multiple activ√©e
ListBox1.MultiSelect := False;  // S√©lection simple (par d√©faut)
```

Avec MultiSelect activ√© :
- **Ctrl+Clic** : Ajouter/retirer un √©l√©ment de la s√©lection
- **Shift+Clic** : S√©lectionner une plage d'√©l√©ments

#### 4. Selected - √âtat de s√©lection des √©l√©ments

Pour les listes en mode MultiSelect, indique si chaque √©l√©ment est s√©lectionn√© :

```pascal
// S√©lectionner un √©l√©ment
ListBox1.Selected[0] := True;

// D√©s√©lectionner un √©l√©ment
ListBox1.Selected[2] := False;

// V√©rifier si un √©l√©ment est s√©lectionn√©
if ListBox1.Selected[0] then
  ShowMessage('Premier √©l√©ment s√©lectionn√©');

// Parcourir tous les √©l√©ments s√©lectionn√©s
for i := 0 to ListBox1.Items.Count - 1 do
begin
  if ListBox1.Selected[i] then
    ListeSelectionnee.Add(ListBox1.Items[i]);
end;
```

#### 5. Sorted - Tri automatique

Si True, les √©l√©ments sont automatiquement tri√©s par ordre alphab√©tique :

```pascal
ListBox1.Sorted := True;   // Tri alphab√©tique
ListBox1.Sorted := False;  // Ordre d'insertion (par d√©faut)
```

**Attention :** Si Sorted est True, les index peuvent changer lors de l'ajout d'√©l√©ments.

#### 6. Style - Style d'affichage

D√©termine comment les √©l√©ments sont affich√©s :

```pascal
ListBox1.Style := lbStandard;      // Standard (texte seulement)
ListBox1.Style := lbOwnerDrawFixed; // Dessin personnalis√©, hauteur fixe
ListBox1.Style := lbOwnerDrawVariable; // Dessin personnalis√©, hauteur variable
```

#### 7. IntegralHeight - Hauteur int√©grale

Si True, la hauteur de la liste est ajust√©e pour afficher des √©l√©ments complets :

```pascal
ListBox1.IntegralHeight := True;   // Pas d'√©l√©ments partiellement visibles (par d√©faut)
ListBox1.IntegralHeight := False;  // Hauteur exacte d√©finie
```

#### 8. ExtendedSelect - S√©lection √©tendue

Active la s√©lection avec Shift et Ctrl :

```pascal
ListBox1.ExtendedSelect := True;   // Activer (par d√©faut)
ListBox1.ExtendedSelect := False;  // D√©sactiver
```

#### 9. Columns - Affichage en colonnes

Affiche les √©l√©ments sur plusieurs colonnes :

```pascal
ListBox1.Columns := 0;  // Une seule colonne (par d√©faut)
ListBox1.Columns := 2;  // Deux colonnes
ListBox1.Columns := 3;  // Trois colonnes
```

### Utilisation pratique de TListBox

#### Exemple 1 : Liste simple avec s√©lection

```pascal
procedure TForm1.FormCreate(Sender: TObject);
begin
  // Remplir la liste
  ListBox1.Items.Clear;
  ListBox1.Items.AddStrings(['Alice', 'Bob', 'Charlie', 'Diana', '√âric']);
  ListBox1.Sorted := True;
  ListBox1.ItemIndex := 0;  // S√©lectionner le premier
end;

procedure TForm1.ListBox1Click(Sender: TObject);
begin
  if ListBox1.ItemIndex >= 0 then
    LabelSelection.Caption := 'Vous avez s√©lectionn√© : ' +
                              ListBox1.Items[ListBox1.ItemIndex];
end;
```

#### Exemple 2 : S√©lection multiple et traitement

```pascal
procedure TForm1.FormCreate(Sender: TObject);
begin
  ListBox1.Items.AddStrings(['PDF', 'Word', 'Excel', 'PowerPoint', 'HTML']);
  ListBox1.MultiSelect := True;
  ListBox1.ExtendedSelect := True;
end;

procedure TForm1.ButtonExporterClick(Sender: TObject);
var
  i: Integer;
  Formats: TStringList;
begin
  Formats := TStringList.Create;
  try
    // Collecter tous les formats s√©lectionn√©s
    for i := 0 to ListBox1.Items.Count - 1 do
    begin
      if ListBox1.Selected[i] then
        Formats.Add(ListBox1.Items[i]);
    end;

    if Formats.Count = 0 then
    begin
      ShowMessage('Veuillez s√©lectionner au moins un format');
      Exit;
    end;

    // Afficher les formats s√©lectionn√©s
    ShowMessage('Formats s√©lectionn√©s : ' + Formats.CommaText);
  finally
    Formats.Free;
  end;
end;
```

#### Exemple 3 : Recherche et filtrage

```pascal
var
  ListeComplete: TStringList;

procedure TForm1.FormCreate(Sender: TObject);
begin
  // Garder une copie de la liste compl√®te
  ListeComplete := TStringList.Create;
  ListeComplete.AddStrings(['Alice Martin', 'Bob Dupont', 'Charlie Bernard',
                            'Diana Petit', '√âric Durand', 'Fanny Moreau']);

  // Afficher toute la liste
  ListBox1.Items.Assign(ListeComplete);
end;

procedure TForm1.EditRechercheChange(Sender: TObject);
var
  i: Integer;
  TexteRecherche: string;
begin
  TexteRecherche := LowerCase(Trim(EditRecherche.Text));

  ListBox1.Items.Clear;

  if TexteRecherche = '' then
    // Afficher tout
    ListBox1.Items.Assign(ListeComplete)
  else
  begin
    // Filtrer
    for i := 0 to ListeComplete.Count - 1 do
    begin
      if Pos(TexteRecherche, LowerCase(ListeComplete[i])) > 0 then
        ListBox1.Items.Add(ListeComplete[i]);
    end;
  end;
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  ListeComplete.Free;
end;
```

#### Exemple 4 : D√©placer des √©l√©ments entre deux listes

```pascal
procedure TForm1.ButtonAjouterClick(Sender: TObject);
var
  i: Integer;
begin
  // D√©placer les √©l√©ments s√©lectionn√©s de ListBox1 vers ListBox2
  for i := ListBox1.Items.Count - 1 downto 0 do
  begin
    if ListBox1.Selected[i] then
    begin
      ListBox2.Items.Add(ListBox1.Items[i]);
      ListBox1.Items.Delete(i);
    end;
  end;
end;

procedure TForm1.ButtonRetirerClick(Sender: TObject);
var
  i: Integer;
begin
  // D√©placer les √©l√©ments s√©lectionn√©s de ListBox2 vers ListBox1
  for i := ListBox2.Items.Count - 1 downto 0 do
  begin
    if ListBox2.Selected[i] then
    begin
      ListBox1.Items.Add(ListBox2.Items[i]);
      ListBox2.Items.Delete(i);
    end;
  end;
end;

procedure TForm1.ButtonToutAjouterClick(Sender: TObject);
begin
  // D√©placer tout de ListBox1 vers ListBox2
  ListBox2.Items.AddStrings(ListBox1.Items);
  ListBox1.Items.Clear;
end;

procedure TForm1.ButtonToutRetirerClick(Sender: TObject);
begin
  // D√©placer tout de ListBox2 vers ListBox1
  ListBox1.Items.AddStrings(ListBox2.Items);
  ListBox2.Items.Clear;
end;
```

#### Exemple 5 : Associer des objets aux √©l√©ments

```pascal
type
  TClient = class
    ID: Integer;
    Nom: string;
    Email: string;
    constructor Create(AID: Integer; const ANom, AEmail: string);
  end;

constructor TClient.Create(AID: Integer; const ANom, AEmail: string);
begin
  ID := AID;
  Nom := ANom;
  Email := AEmail;
end;

procedure TForm1.FormCreate(Sender: TObject);
var
  Client: TClient;
begin
  // Ajouter des clients avec objets associ√©s
  Client := TClient.Create(1, 'Alice Martin', 'alice@example.com');
  ListBox1.Items.AddObject(Client.Nom, Client);

  Client := TClient.Create(2, 'Bob Dupont', 'bob@example.com');
  ListBox1.Items.AddObject(Client.Nom, Client);

  Client := TClient.Create(3, 'Charlie Bernard', 'charlie@example.com');
  ListBox1.Items.AddObject(Client.Nom, Client);
end;

procedure TForm1.ListBox1Click(Sender: TObject);
var
  Client: TClient;
begin
  if ListBox1.ItemIndex >= 0 then
  begin
    Client := TClient(ListBox1.Items.Objects[ListBox1.ItemIndex]);
    MemoDetails.Lines.Clear;
    MemoDetails.Lines.Add('ID : ' + IntToStr(Client.ID));
    MemoDetails.Lines.Add('Nom : ' + Client.Nom);
    MemoDetails.Lines.Add('Email : ' + Client.Email);
  end;
end;

procedure TForm1.FormDestroy(Sender: TObject);
var
  i: Integer;
begin
  // Lib√©rer tous les objets associ√©s
  for i := 0 to ListBox1.Items.Count - 1 do
    ListBox1.Items.Objects[i].Free;
end;
```

### √âv√©nements importants de TListBox

**OnClick** : D√©clench√© quand l'utilisateur clique sur un √©l√©ment

```pascal
procedure TForm1.ListBox1Click(Sender: TObject);
begin
  // Traiter la s√©lection
end;
```

**OnDblClick** : D√©clench√© lors d'un double-clic

```pascal
procedure TForm1.ListBox1DblClick(Sender: TObject);
begin
  if ListBox1.ItemIndex >= 0 then
    OuvrirDetail(ListBox1.Items[ListBox1.ItemIndex]);
end;
```

**OnKeyDown** : D√©clench√© quand une touche est press√©e

```pascal
procedure TForm1.ListBox1KeyDown(Sender: TObject; var Key: Word;
                                  Shift: TShiftState);
begin
  if Key = VK_DELETE then
  begin
    if ListBox1.ItemIndex >= 0 then
      ListBox1.Items.Delete(ListBox1.ItemIndex);
  end;
end;
```

### Astuces pour TListBox

#### 1. D√©s√©lectionner tout

```pascal
ListBox1.ItemIndex := -1;  // S√©lection simple

// Pour MultiSelect
for i := 0 to ListBox1.Items.Count - 1 do
  ListBox1.Selected[i] := False;
```

#### 2. S√©lectionner tout (MultiSelect)

```pascal
procedure TForm1.SelectionnerTout;
var
  i: Integer;
begin
  for i := 0 to ListBox1.Items.Count - 1 do
    ListBox1.Selected[i] := True;
end;
```

#### 3. Compter les √©l√©ments s√©lectionn√©s

```pascal
function TForm1.NombreSelections: Integer;
var
  i: Integer;
begin
  Result := 0;
  for i := 0 to ListBox1.Items.Count - 1 do
  begin
    if ListBox1.Selected[i] then
      Inc(Result);
  end;
end;
```

#### 4. √âviter le scintillement lors de mises √† jour

```pascal
ListBox1.Items.BeginUpdate;
try
  ListBox1.Items.Clear;
  // Ajouter beaucoup d'√©l√©ments
  for i := 0 to 10000 do
    ListBox1.Items.Add('√âl√©ment ' + IntToStr(i));
finally
  ListBox1.Items.EndUpdate;
end;
```

## Le composant TCheckListBox (Liste avec cases √† cocher)

### Qu'est-ce qu'un TCheckListBox ?

**TCheckListBox** est une liste o√π chaque √©l√©ment poss√®de une **case √† cocher**. C'est id√©al pour permettre la s√©lection multiple d'options de mani√®re visuelle.

**Utilisations courantes :**
- S√©lectionner plusieurs options dans une liste
- Activer/d√©sactiver plusieurs fonctionnalit√©s
- Choisir des colonnes √† afficher
- S√©lectionner des filtres

### O√π trouver TCheckListBox ?

TCheckListBox se trouve dans l'onglet **Additional** de la palette de composants.

### Propri√©t√©s essentielles de TCheckListBox

TCheckListBox h√©rite de toutes les propri√©t√©s de TListBox, avec en plus :

#### 1. Checked - √âtat des cases

Indique si la case d'un √©l√©ment est coch√©e :

```pascal
// Cocher un √©l√©ment
CheckListBox1.Checked[0] := True;

// D√©cocher un √©l√©ment
CheckListBox1.Checked[2] := False;

// V√©rifier si un √©l√©ment est coch√©
if CheckListBox1.Checked[0] then
  ShowMessage('Premier √©l√©ment coch√©');
```

#### 2. State - √âtat √† trois valeurs

Comme TCheckBox, peut avoir trois √©tats :

```pascal
CheckListBox1.State[0] := cbUnchecked;  // D√©coch√©
CheckListBox1.State[0] := cbChecked;    // Coch√©
CheckListBox1.State[0] := cbGrayed;     // Ind√©termin√©
```

#### 3. AllowGrayed - Autoriser l'√©tat gris√©

```pascal
CheckListBox1.AllowGrayed := True;   // Trois √©tats possibles
CheckListBox1.AllowGrayed := False;  // Deux √©tats seulement (par d√©faut)
```

### Utilisation pratique de TCheckListBox

#### Exemple 1 : S√©lection de colonnes √† afficher

```pascal
procedure TForm1.FormCreate(Sender: TObject);
begin
  CheckListBox1.Items.AddStrings(['Nom', 'Pr√©nom', 'Email', 'T√©l√©phone', 'Adresse']);

  // Cocher les colonnes affich√©es par d√©faut
  CheckListBox1.Checked[0] := True;  // Nom
  CheckListBox1.Checked[1] := True;  // Pr√©nom
  CheckListBox1.Checked[2] := True;  // Email
end;

procedure TForm1.ButtonAppliquerClick(Sender: TObject);
var
  i: Integer;
begin
  // Afficher les colonnes s√©lectionn√©es
  StringGrid1.ColCount := 0;

  for i := 0 to CheckListBox1.Items.Count - 1 do
  begin
    if CheckListBox1.Checked[i] then
    begin
      StringGrid1.ColCount := StringGrid1.ColCount + 1;
      StringGrid1.Cells[StringGrid1.ColCount - 1, 0] := CheckListBox1.Items[i];
    end;
  end;
end;
```

#### Exemple 2 : Filtres de recherche

```pascal
procedure TForm1.FormCreate(Sender: TObject);
begin
  CheckListBoxFiltres.Items.AddStrings(['Documents', 'Images', 'Vid√©os', 'Audio']);

  // Tous coch√©s par d√©faut
  for i := 0 to CheckListBoxFiltres.Items.Count - 1 do
    CheckListBoxFiltres.Checked[i] := True;
end;

procedure TForm1.CheckListBoxFiltresClickCheck(Sender: TObject);
begin
  // Mettre √† jour la recherche quand un filtre change
  AppliquerFiltres;
end;

procedure TForm1.AppliquerFiltres;
var
  i: Integer;
  FiltresActifs: TStringList;
begin
  FiltresActifs := TStringList.Create;
  try
    for i := 0 to CheckListBoxFiltres.Items.Count - 1 do
    begin
      if CheckListBoxFiltres.Checked[i] then
        FiltresActifs.Add(CheckListBoxFiltres.Items[i]);
    end;

    RechercherAvecFiltres(FiltresActifs);
  finally
    FiltresActifs.Free;
  end;
end;
```

#### Exemple 3 : Tout cocher / Tout d√©cocher

```pascal
procedure TForm1.ButtonToutCocherClick(Sender: TObject);
var
  i: Integer;
begin
  for i := 0 to CheckListBox1.Items.Count - 1 do
    CheckListBox1.Checked[i] := True;
end;

procedure TForm1.ButtonToutDecocherClick(Sender: TObject);
var
  i: Integer;
begin
  for i := 0 to CheckListBox1.Items.Count - 1 do
    CheckListBox1.Checked[i] := False;
end;

procedure TForm1.ButtonInverserClick(Sender: TObject);
var
  i: Integer;
begin
  for i := 0 to CheckListBox1.Items.Count - 1 do
    CheckListBox1.Checked[i] := not CheckListBox1.Checked[i];
end;
```

### √âv√©nements importants de TCheckListBox

**OnClickCheck** : D√©clench√© quand une case est coch√©e/d√©coch√©e

```pascal
procedure TForm1.CheckListBox1ClickCheck(Sender: TObject);
begin
  // R√©agir au changement d'√©tat
  MettreAJourAffichage;
end;
```

## Le composant TStringGrid (Grille de texte)

### Qu'est-ce qu'un TStringGrid ?

**TStringGrid** affiche des donn√©es sous forme de **grille** (tableau) avec des lignes et des colonnes. C'est comme un tableur simplifi√© int√©gr√© dans votre application.

**Utilisations courantes :**
- Afficher des donn√©es tabulaires
- Cr√©er des feuilles de calcul simples
- Afficher des r√©sultats de requ√™tes
- Tableaux de saisie

### O√π trouver TStringGrid ?

TStringGrid se trouve dans l'onglet **Additional** de la palette de composants.

### Propri√©t√©s essentielles de TStringGrid

#### 1. Cells - Contenu des cellules

Permet d'acc√©der au contenu de chaque cellule :

```pascal
// D√©finir le contenu d'une cellule
StringGrid1.Cells[0, 0] := 'Nom';      // Colonne 0, Ligne 0
StringGrid1.Cells[1, 0] := 'Pr√©nom';   // Colonne 1, Ligne 0
StringGrid1.Cells[0, 1] := 'Dupont';   // Colonne 0, Ligne 1

// Lire le contenu
Valeur := StringGrid1.Cells[0, 1];
```

**Note :** Les indices commencent √† 0.

#### 2. ColCount et RowCount - Nombre de colonnes et lignes

```pascal
StringGrid1.ColCount := 5;   // 5 colonnes
StringGrid1.RowCount := 10;  // 10 lignes
```

#### 3. FixedCols et FixedRows - Lignes/colonnes fixes

Les lignes et colonnes fixes ne d√©filent pas et sont affich√©es diff√©remment :

```pascal
StringGrid1.FixedCols := 1;   // Premi√®re colonne fixe
StringGrid1.FixedRows := 1;   // Premi√®re ligne fixe (en-t√™tes)
```

#### 4. ColWidths et RowHeights - Largeurs et hauteurs

```pascal
// D√©finir la largeur d'une colonne
StringGrid1.ColWidths[0] := 150;
StringGrid1.ColWidths[1] := 100;

// D√©finir la hauteur d'une ligne
StringGrid1.RowHeights[0] := 30;
```

#### 5. Options - Options de comportement

Ensemble d'options pour contr√¥ler le comportement :

```pascal
StringGrid1.Options := [goFixedVertLine, goFixedHorzLine, goVertLine,
                        goHorzLine, goRangeSelect, goDrawFocusSelected,
                        goRowSizing, goColSizing, goEditing];
```

**Options courantes :**
- `goFixedVertLine` : Lignes verticales dans les zones fixes
- `goFixedHorzLine` : Lignes horizontales dans les zones fixes
- `goVertLine` : Lignes verticales
- `goHorzLine` : Lignes horizontales
- `goRangeSelect` : S√©lection de plages
- `goDrawFocusSelected` : Mettre en surbrillance la s√©lection
- `goRowSizing` : Redimensionner les lignes
- `goColSizing` : Redimensionner les colonnes
- `goEditing` : Permettre l'√©dition
- `goAlwaysShowEditor` : Toujours afficher l'√©diteur
- `goRowSelect` : S√©lectionner toute la ligne

#### 6. ScrollBars - Barres de d√©filement

```pascal
StringGrid1.ScrollBars := ssNone;       // Aucune
StringGrid1.ScrollBars := ssHorizontal; // Horizontale
StringGrid1.ScrollBars := ssVertical;   // Verticale
StringGrid1.ScrollBars := ssBoth;       // Les deux (par d√©faut)
```

#### 7. DefaultColWidth et DefaultRowHeight

```pascal
StringGrid1.DefaultColWidth := 100;  // Largeur par d√©faut
StringGrid1.DefaultRowHeight := 24;  // Hauteur par d√©faut
```

### Utilisation pratique de TStringGrid

#### Exemple 1 : Tableau de donn√©es simple

```pascal
procedure TForm1.FormCreate(Sender: TObject);
var
  i: Integer;
begin
  // Configuration de la grille
  StringGrid1.ColCount := 4;
  StringGrid1.RowCount := 6;
  StringGrid1.FixedRows := 1;
  StringGrid1.FixedCols := 0;

  // En-t√™tes
  StringGrid1.Cells[0, 0] := 'Nom';
  StringGrid1.Cells[1, 0] := 'Pr√©nom';
  StringGrid1.Cells[2, 0] := 'Age';
  StringGrid1.Cells[3, 0] := 'Ville';

  // Donn√©es
  StringGrid1.Cells[0, 1] := 'Dupont';
  StringGrid1.Cells[1, 1] := 'Jean';
  StringGrid1.Cells[2, 1] := '35';
  StringGrid1.Cells[3, 1] := 'Paris';

  StringGrid1.Cells[0, 2] := 'Martin';
  StringGrid1.Cells[1, 2] := 'Marie';
  StringGrid1.Cells[2, 2] := '28';
  StringGrid1.Cells[3, 2] := 'Lyon';

  // Ajuster les largeurs
  StringGrid1.ColWidths[0] := 120;
  StringGrid1.ColWidths[1] := 120;
  StringGrid1.ColWidths[2] := 60;
  StringGrid1.ColWidths[3] := 120;
end;
```

#### Exemple 2 : Remplir depuis une liste

```pascal
procedure TForm1.RemplirGrille(Liste: TStringList);
var
  i, j: Integer;
  Ligne: TStringList;
begin
  Ligne := TStringList.Create;
  try
    StringGrid1.RowCount := Liste.Count + 1;  // +1 pour l'en-t√™te

    for i := 0 to Liste.Count - 1 do
    begin
      Ligne.CommaText := Liste[i];
      for j := 0 to Ligne.Count - 1 do
      begin
        StringGrid1.Cells[j, i + 1] := Ligne[j];
      end;
    end;
  finally
    Ligne.Free;
  end;
end;
```

#### Exemple 3 : Grille √©ditable avec validation

```pascal
procedure TForm1.StringGrid1SetEditText(Sender: TObject; ACol, ARow: Integer;
  const Value: string);
begin
  // Valider la saisie
  if ACol = 2 then  // Colonne Age
  begin
    try
      StrToInt(Value);  // V√©rifier que c'est un nombre
    except
      ShowMessage('L''√¢ge doit √™tre un nombre');
      StringGrid1.Cells[ACol, ARow] := '';
    end;
  end;
end;

procedure TForm1.StringGrid1SelectCell(Sender: TObject; ACol, ARow: Integer;
  var CanSelect: Boolean);
begin
  // Afficher les d√©tails de la ligne s√©lectionn√©e
  if ARow > 0 then
  begin
    MemoDetails.Lines.Clear;
    MemoDetails.Lines.Add('Nom : ' + StringGrid1.Cells[0, ARow]);
    MemoDetails.Lines.Add('Pr√©nom : ' + StringGrid1.Cells[1, ARow]);
    MemoDetails.Lines.Add('Age : ' + StringGrid1.Cells[2, ARow]);
    MemoDetails.Lines.Add('Ville : ' + StringGrid1.Cells[3, ARow]);
  end;
end;
```

#### Exemple 4 : Ajouter et supprimer des lignes

```pascal
procedure TForm1.ButtonAjouterLigneClick(Sender: TObject);
begin
  StringGrid1.RowCount := StringGrid1.RowCount + 1;
  // La nouvelle ligne est vide
end;

procedure TForm1.ButtonSupprimerLigneClick(Sender: TObject);
var
  i, j: Integer;
  Ligne: Integer;
begin
  Ligne := StringGrid1.Row;

  if Ligne < StringGrid1.FixedRows then
  begin
    ShowMessage('Impossible de supprimer l''en-t√™te');
    Exit;
  end;

  // D√©caler toutes les lignes vers le haut
  for i := Ligne to StringGrid1.RowCount - 2 do
  begin
    for j := 0 to StringGrid1.ColCount - 1 do
    begin
      StringGrid1.Cells[j, i] := StringGrid1.Cells[j, i + 1];
    end;
  end;

  // R√©duire le nombre de lignes
  StringGrid1.RowCount := StringGrid1.RowCount - 1;
end;
```

#### Exemple 5 : Exporter vers CSV

```pascal
procedure TForm1.ExporterVersCSV(const NomFichier: string);
var
  i, j: Integer;
  Ligne: string;
  Fichier: TextFile;
begin
  AssignFile(Fichier, NomFichier);
  try
    Rewrite(Fichier);

    // Exporter toutes les lignes
    for i := 0 to StringGrid1.RowCount - 1 do
    begin
      Ligne := '';
      for j := 0 to StringGrid1.ColCount - 1 do
      begin
        if j > 0 then
          Ligne := Ligne + ',';
        Ligne := Ligne + StringGrid1.Cells[j, i];
      end;
      Writeln(Fichier, Ligne);
    end;
  finally
    CloseFile(Fichier);
  end;
end;
```

### √âv√©nements importants de TStringGrid

**OnSelectCell** : D√©clench√© quand une cellule est s√©lectionn√©e

```pascal
procedure TForm1.StringGrid1SelectCell(Sender: TObject; ACol, ARow: Integer;
  var CanSelect: Boolean);
begin
  // CanSelect = False pour emp√™cher la s√©lection
end;
```

**OnDrawCell** : Permet de dessiner personnalis√© dans les cellules

```pascal
procedure TForm1.StringGrid1DrawCell(Sender: TObject; ACol, ARow: Integer;
  Rect: TRect; State: TGridDrawState);
begin
  // Personnaliser l'affichage
  if ARow > 0 then
  begin
    if StrToIntDef(StringGrid1.Cells[2, ARow], 0) < 30 then
    begin
      StringGrid1.Canvas.Brush.Color := clYellow;
      StringGrid1.Canvas.FillRect(Rect);
    end;
  end;

  // Dessiner le texte
  StringGrid1.Canvas.TextOut(Rect.Left + 2, Rect.Top + 2,
                             StringGrid1.Cells[ACol, ARow]);
end;
```

## Le composant TListView (Liste avanc√©e)

### Qu'est-ce qu'un TListView ?

**TListView** est un composant avanc√© qui affiche des listes avec plusieurs **modes de visualisation** (ic√¥nes, liste, d√©tails). C'est le composant utilis√© dans l'Explorateur Windows.

**Utilisations courantes :**
- Afficher des fichiers et dossiers
- Listes de produits avec d√©tails
- Catalogues
- Tout ce qui n√©cessite plusieurs vues

### O√π trouver TListView ?

TListView se trouve dans l'onglet **Win32** de la palette de composants.

### Propri√©t√©s essentielles de TListView

#### 1. ViewStyle - Style de vue

D√©termine comment les √©l√©ments sont affich√©s :

```pascal
ListView1.ViewStyle := vsIcon;      // Grandes ic√¥nes
ListView1.ViewStyle := vsSmallIcon; // Petites ic√¥nes
ListView1.ViewStyle := vsList;      // Liste
ListView1.ViewStyle := vsReport;    // D√©tails (avec colonnes)
```

#### 2. Items - Les √©l√©ments

Collection d'√©l√©ments √† afficher :

```pascal
var
  Item: TListItem;
begin
  // Ajouter un √©l√©ment
  Item := ListView1.Items.Add;
  Item.Caption := 'Document.txt';
  Item.SubItems.Add('10 Ko');
  Item.SubItems.Add('12/10/2024');
end;
```

#### 3. Columns - Les colonnes (mode Report)

D√©finit les colonnes en mode d√©tails :

```pascal
procedure TForm1.FormCreate(Sender: TObject);
var
  Col: TListColumn;
begin
  ListView1.ViewStyle := vsReport;

  // Colonne Nom
  Col := ListView1.Columns.Add;
  Col.Caption := 'Nom';
  Col.Width := 200;

  // Colonne Taille
  Col := ListView1.Columns.Add;
  Col.Caption := 'Taille';
  Col.Width := 100;

  // Colonne Date
  Col := ListView1.Columns.Add;
  Col.Caption := 'Date';
  Col.Width := 120;
end;
```

#### 4. MultiSelect - S√©lection multiple

```pascal
ListView1.MultiSelect := True;   // S√©lection multiple
ListView1.MultiSelect := False;  // S√©lection simple
```

#### 5. GridLines - Lignes de grille

Affiche des lignes de grille en mode Report :

```pascal
ListView1.GridLines := True;   // Avec lignes
ListView1.GridLines := False;  // Sans lignes
```

#### 6. RowSelect - S√©lection de ligne compl√®te

```pascal
ListView1.RowSelect := True;   // S√©lectionne toute la ligne
ListView1.RowSelect := False;  // S√©lectionne seulement la premi√®re colonne
```

### Utilisation pratique de TListView

#### Exemple 1 : Liste de fichiers

```pascal
procedure TForm1.FormCreate(Sender: TObject);
var
  SearchRec: TSearchRec;
  Item: TListItem;
begin
  // Configuration
  ListView1.ViewStyle := vsReport;
  ListView1.GridLines := True;
  ListView1.RowSelect := True;

  // Colonnes
  with ListView1.Columns.Add do
  begin
    Caption := 'Nom';
    Width := 200;
  end;

  with ListView1.Columns.Add do
  begin
    Caption := 'Taille';
    Width := 100;
  end;

  with ListView1.Columns.Add do
  begin
    Caption := 'Date';
    Width := 120;
  end;

  // Lister les fichiers
  if FindFirst('C:\Windows\*.exe', faAnyFile, SearchRec) = 0 then
  begin
    repeat
      Item := ListView1.Items.Add;
      Item.Caption := SearchRec.Name;
      Item.SubItems.Add(FormatFloat('#,##0', SearchRec.Size) + ' octets');
      Item.SubItems.Add(DateTimeToStr(FileDateToDateTime(SearchRec.Time)));
    until FindNext(SearchRec) <> 0;
    FindClose(SearchRec);
  end;
end;
```

#### Exemple 2 : Changer de vue

```pascal
procedure TForm1.ButtonIconesClick(Sender: TObject);
begin
  ListView1.ViewStyle := vsIcon;
end;

procedure TForm1.ButtonListeClick(Sender: TObject);
begin
  ListView1.ViewStyle := vsList;
end;

procedure TForm1.ButtonDetailsClick(Sender: TObject);
begin
  ListView1.ViewStyle := vsReport;
end;
```

#### Exemple 3 : Tri des colonnes

```pascal
procedure TForm1.ListView1ColumnClick(Sender: TObject; Column: TListColumn);
begin
  // Trier par la colonne cliqu√©e
  ListView1.SortType := stText;
  ListView1.Column[Column.Index].Tag := 1 - ListView1.Column[Column.Index].Tag;

  if ListView1.Column[Column.Index].Tag = 0 then
    ListView1.Sorted := True  // Croissant
  else
    ListView1.Sorted := False; // D√©croissant
end;
```

## Bonnes pratiques pour les listes et grilles

### 1. Optimisation des performances

```pascal
// D√©sactiver le rafra√Æchissement pendant le remplissage
ListView1.Items.BeginUpdate;
try
  // Ajouter beaucoup d'√©l√©ments
  for i := 0 to 10000 do
    AjouterElement(i);
finally
  ListView1.Items.EndUpdate;
end;
```

### 2. Lib√©ration de la m√©moire

```pascal
// Toujours lib√©rer les objets associ√©s
for i := 0 to ListBox1.Items.Count - 1 do
begin
  if Assigned(ListBox1.Items.Objects[i]) then
    ListBox1.Items.Objects[i].Free;
end;
```

### 3. Validation de la s√©lection

```pascal
if ListBox1.ItemIndex >= 0 then
  // Traiter
else
  ShowMessage('Veuillez s√©lectionner un √©l√©ment');
```

### 4. Interface responsive

```pascal
// Afficher une barre de progression pour les op√©rations longues
ProgressBar1.Max := ListView1.Items.Count;
for i := 0 to ListView1.Items.Count - 1 do
begin
  TraiterElement(i);
  ProgressBar1.Position := i + 1;
  Application.ProcessMessages;  // Garder l'interface r√©active
end;
```

### 5. Recherche efficace

```pascal
// Utiliser IndexOf pour rechercher
Index := ListBox1.Items.IndexOf('Texte recherch√©');
if Index >= 0 then
  ListBox1.ItemIndex := Index;
```

## Tableau comparatif

| Composant | Avantage | Utilisation typique |
|-----------|----------|---------------------|
| TListBox | Simple et rapide | Listes simples |
| TCheckListBox | Cases √† cocher int√©gr√©es | S√©lections multiples visuelles |
| TStringGrid | Tableau structur√© | Donn√©es tabulaires |
| TListView | Vues multiples | Fichiers, catalogues |

## Conclusion

Les composants de listes et de grilles sont essentiels pour afficher et manipuler des collections de donn√©es dans vos applications. Chacun a ses forces et ses cas d'usage sp√©cifiques.

**Points cl√©s √† retenir :**

**TListBox :**
- Simple et efficace pour des listes d'√©l√©ments
- Support de la s√©lection simple ou multiple
- Peut associer des objets aux √©l√©ments
- Id√©al pour des listes simples

**TCheckListBox :**
- Cases √† cocher int√©gr√©es
- Parfait pour s√©lectionner plusieurs options
- Tout cocher/d√©cocher facilement
- Excellent pour les filtres et options

**TStringGrid :**
- Affichage tabulaire de donn√©es
- √âdition de cellules
- Lignes et colonnes fixes
- Id√©al pour les tableaux de donn√©es

**TListView :**
- Vues multiples (ic√¥nes, liste, d√©tails)
- Colonnes avec tri
- Interface style Explorateur Windows
- Parfait pour les fichiers et catalogues

En ma√Ætrisant ces composants, vous pouvez cr√©er des interfaces riches et interactives pour afficher et manipuler efficacement toutes sortes de collections de donn√©es dans vos applications Delphi.

Dans la prochaine section, nous explorerons les contr√¥les avanc√©s comme PageControl, TreeView et autres composants sophistiqu√©s pour cr√©er des interfaces encore plus complexes.

‚è≠Ô∏è [Contr√¥les avanc√©s (PageControl, TreeView, ListView)](/04-conception-dinterfaces-utilisateur-avec-la-vcl/04-controles-avances.md)
